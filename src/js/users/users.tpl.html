<div class='container'  ng-if="auth.isAtleast('inventory')" ng-controller="UserCtrl">
    <button type="button"
            ng:cloak
            data-placement="center"
            class="btn btn-lg btn-primary pull-right topMargin5 bottomMargin5"
            style="max-width: 100%; width: auto;"
            add-edit-user-modal=""
            on-save="refreshSites"
            sites="sites"
            data-animation="am-fade-and-scale">New user/customer</button>
    <br>
    <div>
        <div class='pull-right topMargin5'>
            <div class="btn-group" bs-radio-group id="userFilters" ng-model="status_filters_2">
                <label ng-click="setStatusFilter('All')"class="btn btn-default">
                    <input type="radio" value="All"> All</label>
                <label ng-click="setStatusFilter('admin')" class="btn btn-default">
                    <input type="radio" value="Admin"> Admin</label>
                <label ng-click="setStatusFilter('staff')" class="btn btn-default">
                    <input type="radio" value="Staff"> Staff</label>
                <label ng-click="setStatusFilter('customer')" class="btn btn-default">
                    <input type="radio" value="Customer"> Customer</label>
                <label ng-click="setAssignmentFilter('unassigned')" class="btn btn-default">
                    <input type="radio" value="Unassigned"> Unassigned</label>
                <span class="lnk leftSpace10">
                    <a href ng-click='reset()' bs-tooltip title='Reset'>
                        <b><i class="fa fa-rotate-left _red _size5 topMargin5 hoverHighlight"></i></b>
                    </a>
                </span>
            </div>
        </div>
        <br>
        <input type='text' ng-model='data.filterTextEntry' size=20 placeholder='Search'>
        <a ng-if="data.filterTextEntry.length" ng-click="data.filterTextEntry=''" class='fa fa-times _red _size5 hand'></a>
        <span class='gray' ng-if='data.getSiteCount()'> &nbsp; {{data.getSiteCount()}} users being displayed.</span>
    </div>
    <BR><BR>

    <div class='table-responsive' ng-if="displayedUsers.length > 0">
        <table class='table table-striped' id='estimatesList'>
            <thead>
            <tr>
                <th class="clickable-header" ng-click="sh.sortByColumn('email')">
                    Email <i ng-class="sh.columnClass('email')" class='silver'></i>
                </th>
                <th class="clickable-header" ng-click="sh.sortByColumn('fName')">
                    Name <i ng-class="sh.columnClass('fName')" class='silver'></i>
                </th>
                <th ng-if="auth.isAtleast('inventory')" class="clickable-header" ng-click="sh.sortByColumn('role')">
                    Role <i ng-class="sh.columnClass('role')" class='silver'></i>
                </th>
                <th class="clickable-header" ng-click="sh.sortByColumn('sessionCount')">
                    Login count <i ng-class="sh.columnClass('sessionCount')" class='silver'></i>
                </th>
                <th>
                    Assigned <i class='silver'></i>
                </th>
                <th style="min-width: 75px;"></th>
            </tr>
            </thead>
            <tbody infinite-scroll="showMoreUsers()" infinite-scroll-distance="3">
            <tr ng-repeat="e in displayedUsers track by $index" class='hoverHotspot' id='item_{{e.reportID}}'>
                <td  style="text-decoration:underline;cursor: pointer">
                    <span ng-bind="e.email"  add-edit-user-modal="e" sites="sites" on-save="refreshSites"></span>
                    <a ng-if="e.role=='customer' && e.email!='No Results'" data-backdrop='static'
                       data-keyboard=true
                       bs-modal
                       data-template="js/trees/emailReport.tpl.html"
                       ng-click="sendPortalLink(e)"
                            ><i  bs-tooltip title="Send user a portal login link" class="fa fa-gear"></i></a>
                    <a ng-if="e.role!='customer' && e.email!='No Results'" confirm-popup="'Email this user their login information?'" user-id="e.userID" callback="sendLoginInfo" bs-tooltip title="Send user their login information"><i class="fa fa-gear"></i></a>
                </td>
               <!--<td ng-show="e.fName && e.lName" ng-bind="e.fName+' '+e.lName"></td>-->
                <td  ng-bind="e.name"></td>
                <td ng-bind="e.role"></td>
                <td ng-bind="e.sessionCount"></td>
                <td>
                    <a href="" class="badge" style="background-color:blue" ng-bind="e.clientCount"></a>
                    <a href="" class="badge" style="background-color:green" ng-bind="e.siteCount"></a>
                </td>
                <td ></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
